<script type="text/javascript">
  RED.nodes.registerType('Resolve', {
    category: 'Visa Direct',
    defaults: {
      name: { value: '' },
      alias: {
        value: '',
        required: true,
        validate: RED.validators.typedInput('aliasyType'),
      },
      aliasType: { value: '' },
      businessApplicationId: {
        value: '',
        required: true,
        validate: RED.validators.typedInput('businessApplicationIdType'),
      },
      businessApplicationIdType: { value: '' },
      aliasTypeParam: {
        value: '',
        required: false,
        validate: RED.validators.typedInput('aliasTypeParamType'),
      },
      aliasTypeParamType: { value: '' },
      accountLookUp: {
        value: '',
        required: false,
        validate: RED.validators.typedInput('accountLookUpType'),
      },
      accountLookUpType: { value: '' },
    },
    inputs: 1,
    outputs: 3,
    icon: 'visa.svg',
    color: '#2066B1',
    label: function () {
      return this.name || 'Resolve';
    },
    outputLabels: ['Successful response', 'Server and other errors'],
    oneditprepare: function () {
      $('#node-input-alias').typedInput({
        default: 'msg',
        types: ['msg', 'flow', 'global', 'str', 'num'],
        typeField: $('#node-input-aliasType'),
      });

      $('#node-input-businessApplicationId').typedInput({
        types: [
        {
            value: "businessApplicationId",
            options: [
                { value: "PP", label: "PP - Personal payment"},
                { value: "MP", label: "MP - Merchant Payment"},
                { value: "CI", label: "CI - Cash In"},
                { value: "CO", label: "CO - Cash Out"}
            ]
        }
    ]
      });

      $('#node-input-aliasTypeParam').typedInput({
        types: [
        {
            value: "aliasTypeParam",
            options: [
                { value: "01", label: "01 - Phone Number"},
                { value: "02", label: "02 - Email ID"},
                { value: "03", label: "03 - National ID"},
                { value: "04", label: "04 - IBAN"},
            ]
        }]});

      $('#node-input-accountLookUp').typedInput({
        types: [
        {
            value: "accountLookUp",
            options: [
                { value: "Y", label: "Y - Yes"},
                { value: "N", label: "N - No"}
            ]
        }]}

      );
    },
  });
</script>


<script type="text/html" data-help-name="Resolve">
    <p>This node provides recipient's primary account and related data associated with the input Alias.</p>
    <div>
        <h3>Details</h3>
        <dl class="message-properties">
            <p>
                The Resolve API provides recipient's primary account and related data associated with the input Alias.
                This node uses v2.
                You can find more info <a
                    href="https://developer.visa.com/capabilities/visa_direct/reference#tag/Visa-Alias-Directory-API/operation/Resolve%20V2_v2%20-%20Latest">here</a>
            </p>
        </dl>
    </div>
    <div>
        <h3>Inputs</h3>
        <dl class="message-properties">
            <p>
                On input, this node accepts the body fields of the future request.
                All the information about payload you can find <a
                    href="https://developer.visa.com/capabilities/visa_direct/reference#tag/Visa-Alias-Directory-API/operation/Resolve%20V2_v2%20-%20Latest">here.</a>
                You don't need to worry about apiKey or other credentials.
                Node gets them from environment variables.
            </p>
        </dl>
    </div>
    <div>
        <h3>Outputs</h3>
        <dl class="message-properties">
            <p> This node has three outputs. First, use a good response. You can get the results in
                <code>msg.payload</code>.
                Second output for error handling. It throws an error in the next field, <code>msg.error</code>.
                Both outputs send response status in the status field.
            </p>
        </dl>
    </div>
</script>

<style>
  .inputs-design {
  display: flex;
      align-items: center;
      justify-content: flex-start;
      width: 650px;
  }
  </style>

<script type="text/html" data-template-name="Resolve">
    <div class="form-row inputs-design">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="name">
    </div>

    <div class="form-row inputs-design">
      <label for="person-info"><strong>User Options</strong></label><br/>
    </div>

    <div class="form-row inputs-design">
        <label for="node-input-alias"><i class="fa fa-address-card"></i> Alias</label>
        <input type="text" id="node-input-alias" placeholder="Alias">
        <input type="hidden" id="node-input-aliasType">
    </div>

    <div class="form-row inputs-design">
      <label for="person-info"><strong>Extra Options</strong></label><br/>
    </div>

    <div class="form-row inputs-design">
        <label for="node-input-businessApplicationId"><i class="fa fa-tag"></i> Business Application ID</label>
        <input type="text" id="node-input-businessApplicationId" placeholder="Business Application ID">
        <input type="hidden" id="node-input-businessApplicationIdType">
    </div>

    <div class="form-row inputs-design">
        <label for="node-input-aliasTypeParam"><i class="fa fa-tag"></i> Alias Type</label>
        <input type="text" id="node-input-aliasTypeParam" placeholder="Alias Type">
        <input type="hidden" id="node-input-aliasTypeParamType">
    </div>

    <div class="form-row inputs-design">
        <label for="node-input-accountLookUp"><i class="fa fa-tag"></i> Account LookUp</label>
        <input type="text" id="node-input-accountLookUp" placeholder="Account LookUp">
        <input type="hidden" id="node-input-accountLookUpType">
    </div>
</script>
